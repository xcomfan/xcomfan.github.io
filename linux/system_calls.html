<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>System Calls | My References</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="System Calls" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="http://0.0.0.0:4000/linux/system_calls" />
<meta property="og:url" content="http://0.0.0.0:4000/linux/system_calls" />
<meta property="og:site_name" content="My References" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="System Calls" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"System Calls","url":"http://0.0.0.0:4000/linux/system_calls"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="My References" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">My References</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">System Calls</h1>
  </header>

  <div class="post-content">
    <p>A system call is a controlled entry point into the kernel, allowing a process to request that the kernel perform some action on the process’s behalf. The <code class="language-plaintext highlighter-rouge">syscalls(2)</code> manual page lists the Linux system calls. A system call changes the processor state form user mode to kernel mode, so that the CPU can access protected kernel memory. The set of system calls is fixed. Each system call is identified by a unique number. This numbering scheme is not normally visible to programs, which identify system calls by name.</p>

<p>Each system call may have a set of arguments that specify information to be transferred from user space (i.e, the process’s virtual address space) to kernel space and vice versa.  From a programming point of view invoking a system call looks much like calling a C function. However, behind the scenes, many steps occur during the execution of a system call. The below steps follow an x86-32 implementation…</p>

<ol>
  <li>
    <p>The application program makes a system call by invoking a wrapper function in the C library</p>
  </li>
  <li>
    <p>The wrapper function must make all of the system call arguments available to the system call trap-handling routine (described below). These arguments are passed to the  wrapper via the stack, but the kernel expects them in specific registers.  The wrapper function copies the arguments to these registers.</p>
  </li>
  <li>
    <p>Since all system calls enter the kernel in the same way, the kernel needs some method of identifying the system call.  To permit this, the wrapper function copies the system call number into a specific CPU register (%eax)</p>
  </li>
  <li>
    <p>The wrapper function executes a trap machine instruction (int 0x80) which causes the processor to switch from user mode to kernel mode and execute code pointed to by location 0x80 (128 in decimal) of the system trap vector.</p>
  </li>
  <li>
    <p>In response to the trap to location 0x80, the kernel invokes its <code class="language-plaintext highlighter-rouge">system_call()</code> routine (located in the assembler file <code class="language-plaintext highlighter-rouge">/arch/x86/kernel/entry.s</code>) to handle the trap.  This trap handler…</p>

    <p>a. Saves register values onto the kernel stack</p>

    <p>b. Check the validity of the system call number.</p>

    <p>c. Invokes the appropriate system call service routine, which is found by using the system call number to index to a table of all system call service routines (the kernel variable <code class="language-plaintext highlighter-rouge">sys_call_table</code>j). If the system call service routine has any arguments, it first checks their validity; for example, it checks that addresses point to valid locations in user memory. Then the service routine performs the required task, which may involve modifying values at addresses specified in the given arguments and transferring data between user memory and kernel memory (e.g, in I/O operations) Finally the service routine returns a result status to the <code class="language-plaintext highlighter-rouge">system_call()</code> routine.</p>

    <p>d. Restores register values from the kernel stack and places the system call return value on the stack.</p>

    <p>e. Returns to the wrapper function, simultaneously returning the processor to user mode.</p>
  </li>
  <li>
    <p>If the return value of the system call service routine indicated an error, the wrapper function sets the global variable <code class="language-plaintext highlighter-rouge">errno</code> Using this value wrapper function returns to the caller, providing an integer return value indicating the success or failure of the system call.</p>
  </li>
</ol>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">My References</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">My References</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
